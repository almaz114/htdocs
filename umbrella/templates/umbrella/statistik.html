{% extends "umbrella/statistik_navigate.html" %}

{% load static %}

{% block content %}

<body style="background-color: black; background-size: 100%; background-image:url('/static/umbrella/images/img-06.jpg');">
<h1 style="text-align: center ;"> Статистика торговли алгоритмической системы</h1>

<!-- График торгуемые инструменты -->
<div class="container-fluid">
    <div class="row">
        <div class="col-4" style="display: inline-block; height: 440px; line-height: 440px;">
            <canvas id="chart_1" width="300px" height="300px"
                    style="line-height: 20px; vertical-align: middle; display: inline-block;"></canvas>
        </div>
        <div class="col-4 text-center" style="height: 400px; line-height: 400px;">
            <h1 style="line-height: 20px; vertical-align: middle; display: inline-block;">второй элемент !!!</h1>
        </div>
        <div class="col-4" style="display: inline-block; height: 400px; line-height: 400px;">
            <canvas id="chart_2" width="400px" height="300px"
                    style="line-height: 20px; vertical-align: middle; display: inline-block;"></canvas>
        </div>
        <!-- Инвестиционный калькулятор -->
        <div>
            <tr>
            <h1 style="font-size:30px">Инвестиционный калькулятор</h1>
            <th> Начальный депозит: <div class="input-container"><input type="number" id="start_depo"></div></th>
            <th>Введите % в годовых: <div class="input-container"><input type="number" id="percent_years"></div></th>
            <button id="button_raschet"> Рассчитать </button><br/>
            </tr> <br/>

            <h1 style="color:black;font-size:20px">Доход за год в валюте депозита/счета:</h1>
            <label id="label_1" style="color:blue;font-size:20px"></label><br/>
            <label id="label_2" style="color:blue;font-size:20px"></label>
           </div>

    </div>
</div>


</body>

<script src="{% static 'umbrella/js/jquery-2.2.4.min.js' %}"></script>
<script src="{% static 'umbrella/js/bootstrap.min.js' %}"></script>
<script src="{% static 'umbrella/js/Chart.min.js' %}"></script> 
{# <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script> #}

<!-- =================== Новый метод для вывода 2-х графиков ==============  -->
<script>
    $(function () {
        let ctx = document.getElementById("chart_1").getContext('2d');
        let data = {
            datasets: [{
                label: "Месячная доходность в %",
                data: {{ data|safe }},
                backgroundColor: ['darkred', 'black', 'grey', '#C0C0', '#D3D3D3', 'darkgreen', 'lightblue', 'red'],
            }],
            labels: {{ labels|safe }}
        };
        let myDoughnutChart = new Chart(ctx, {
            type: 'pie',
            data: data,
            options: {
                responsive: false,
                maintainAspectRatio: false,
                legend: {
                    position: 'bottom',
                    labels: {
                        boxWidth: 12
                    }
                }
            }
        });

        let ctx_2 = document.getElementById("chart_2").getContext('2d');
        let data_2 = {
            datasets: [{
                label: 'Месячная доходность в %',
                data: {{ data_2|safe }},
                backgroundColor: ['#696969', '#808080', '#A9A9A9', '#C0C0C0', '#D3D3D3', 'lightgreen', 'lightblue', 'red'],
            }],
            labels: {{ labels_2|safe }}
        };
        let myDoughnutChart_2 = new Chart(ctx_2, {
            type: 'bar',
            data: data_2,
            options: {
                responsive: false,
                maintainAspectRatio: false,
                legend: {
                    position: 'bottom',
                    labels: {
                        boxWidth: 12
                    }
                }
            }
        });
    });


</script>

<!-- =================== Инвестиционный калькулятор ==============  -->
<script>
    let start_depo = document.getElementById("start_depo");        // ввод стартовой суммы
    let percent_years = document.getElementById("percent_years");  // ввод % годовых
    const button = document.getElementById("button_raschet");
    let itog_year = document.getElementById("itog_year");          // вывод суммы за 1 год

    let label_1 = document.getElementById("label_1");              // вывод итоговой
    let label_2 = document.getElementById("label_2");              // вывод итоговой

    button.addEventListener("click", function(event) {
        console.log(start_depo.value);
        start_depo_value = start_depo.value;
        percent_value = percent_years.value;

        // за 1 год
        simple_percent_formula = start_depo_value*(1+percent_value/100);  // простой процент
        new_value =  start_depo_value*(1+percent_value/100/12)**12;    // реинвестирование

        label_1.innerText = "С использованием простого процента: " + simple_percent_formula.toFixed(2);
        label_2.innerText = "С использованием сложного процента (реинвестирование): " + new_value.toFixed(2);

    })
</script>


{% endblock %}
</body>